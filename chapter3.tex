% From mitthesis package
% Version: 1.07, 2024/09/26
% Documentation: https://ctan.org/pkg/mitthesis


\chapter{Convex Optimization of Decomposition of Electron-Electron Interaction Hamiltonian Term}

\section{K-Range Hamiltonian}

Define an electronic structure Hamiltonian from \eqref{eq: H3} as $K$-range if its values $h_{ijkl}$ satisfy the following condition.

\begin{equation}
    \begin{split}
        \hat{H} &= \sum_{i, j} h_{ij}a^\dag_ia_j + \frac{1}{2}\sum_{i,j,k,l} h_{ijkl}a^\dag_ia^\dag_ja_ka_l  \\
        \text{such that } h_{ijkl} &= 0 \text{ if } \min(\max(|i - l|, |j - k|), \max(|i - k|, |j - l|)) > K
    \end{split}
\end{equation}

Any $K$-range Hamiltonian can be rewritten in the following more restrictive form. This is because, for an index $(i, j, k, l)$ such that $\max(|i - k|, |j - l|) > K$ but $\max(|i - l|, |j - k|) \leq K$, we can substitute $h_{ijkl}a^\dag_ia^\dag_ja_la_k = -h_{ijkl}a^\dag_ia^\dag_ja_ka_l$. This term satisfies the more restrictive condition and can be combined with the original term indexed $(i, j, l, k)$. From this process of substitutions and combination we get new terms $\bar{h}_{ijkl}$.

\begin{equation}
    \begin{split}
        \hat{H} &= \sum_{i, j} h_{ij}a^\dag_ia_j + \frac{1}{2}\sum_{i,j,k,l} \bar{h}_{ijkl}a^\dag_ia^\dag_ja_ka_l \\
        \text{such that } \bar{h}_{ijkl} &= 0 \text{ if } \max(|i - l|, |j - k|) > K
    \end{split}
\end{equation}

Then, accordingly with \eqref{eq: H3}, this Hamiltonian can be rearranged, and accordingly with \eqref{eq: DF}, the second term can be factored. The condition does not change.

\begin{equation}
    \begin{split}
        \hat{H} &= \sum_{i, j} h'_{ij}a^\dag_ia_j + \frac{1}{2}\sum_{i,j,k,l} h'_{iljk}a^\dag_ia_la^\dag_ja_k \\
        &= \sum_{i, j} h'_{ij}a^\dag_ia_j + \frac{1}{2}\sum_r\lambda_r\left(\sum_{i,j} Q^{(r)}_{i, j}a^\dag_ia_j\right)^2 \\
        \text{such that } h'_{iljk} &= \bar{h}_{ijkl} = 0 \text{ if } \max(|i - l|, |j - k|) > K
    \end{split}
\end{equation}

Observe that the condition implies that, for all $r$, $Q^{(r)}_{i, j} = 0$ if $|i - j| > K$. This means that all $Q^{(r)}$ are band matrices with bandwidth $K$.

\begin{equation}
    Q^{(r)} = \begin{bmatrix}
        Q^{(r)}_{0, 0} & \cdots & Q^{(r)}_{0, K} & 0 & \cdots & \cdots & \cdots & \cdots & 0 \\
        \vdots & \ddots & \vdots & Q^{(r)}_{1, K + 1} & \ddots & & & & \vdots \\
        Q^{(r)}_{K, 0} & \cdots & \ddots & \ddots & \ddots & \ddots & & & 0 \\
        0 & Q^{(r)}_{K + 1, 1} & \ddots & \ddots & \ddots & \ddots & \ddots & & 0 \\
        \vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
        \vdots & & \ddots & \ddots & \ddots & \ddots & \ddots & Q^{(r)}_{n - K - 2, n - 2} & 0 \\
        \vdots & & & \ddots & \ddots & \ddots & \ddots & \cdots & Q^{(r)}_{n - K - 1, n - 1} \\
        \vdots & & & & \ddots & Q^{(r)}_{n - 2, n - K - 2} & \vdots & \ddots & \vdots \\
        0 & \cdots & \cdots & \cdots & \cdots & 0 & Q^{(r)}_{n - 1, n - K - 1} & \cdots & Q^{(r)}_{n - 1, n - 1}
    \end{bmatrix}
\end{equation}

If $Q^{(r)}$ has bandwidth $K$, this guarantees $R^{(r)}$ can be decomposed into at most $Kn$ Givens rotations, corresponding to at most $O(Kn)$ two-qubit basis rotations comprising $U(R^{(r)})$. \textcolor{red}{PROOF?} Meanwhile, $Q^{(r)}$ has $\Omega(Kn)$ nonzero terms, so the terms cannot combine in the way of \eqref{eq: collapse} and \eqref{eq: collapse2}. Therefore, a $K$-range Hamiltonian can be expressed as a sum of $n^2$ terms, each simulable with $O(n(\log{n} + K))$ gates using the coherent method. We see that the coherent method is therefore particularly useful on such low-range Hamiltonians. For example, if $K = O(\log{n})$, the total number of gates in a single Trotter iteration over these terms is $O(n^3\log{n})$, beating the $O(n^4)$ complexity of a brute force method.

\section{Decomposition of Hamiltonian Term}

We can expand our usage of this coherent method to electronic structure Hamiltonians that are ``low-rangedly dominant''. These are Hamiltonians that are not themselves low-range but can be expressed as a sum of a low-range term $\hat{H}_0$ and a relatively small arbitrary-range term $\Delta \hat{H}$.

\begin{equation}
    \begin{split}
        \hat{H} &= \hat{H}_0 + \Delta \hat{H} \\
        ||\Delta \hat{H}|| &\ll ||\hat{H}_0|| \\
    \end{split}
    \label{eq: LRD}
\end{equation}

$e^{-i\hat{H}_0t}$ is (asymptotically) cheaper, while $e^{-i\Delta \hat{H}t}$ is asymptotically more expensive but it affects the output to a lesser extent (since it's smaller). The idea, then, is to use a randomized Hamiltonian simulation algorithm such as qDRIFT, which samples terms more if they have a higher weight (operator norm). In simulating \eqref{eq: LRD}, the algorithm would perform $e^{-i\hat{H}_0t}$ much more frequently (asymptotically) than $e^{-i\Delta \hat{H}t}$, which is good because the former is cheaper. If the operator norm discrepancy $||\Delta \hat{H}|| \ll ||\hat{H}_0||$ is large enough, $\Delta \hat{H}$ will not contribute too much to the overall cost, while still being performed enough times to simulate $\hat{H}$ precisely.


\section{Gradient Descent}
\section{Gate Count Analysis}
\section{Numerics}


%%%%%%%%%%%%%%%% end table %%%%%%%%%%%%%%%%%%% 

